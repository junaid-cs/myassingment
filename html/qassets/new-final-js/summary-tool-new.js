$(document).ready(function(){var head=document.getElementsByTagName('head')[0];var script=document.createElement('script');script.type='text/javascript';script.id="dropboxjs";script.setAttribute("data-app-key",appKeyDropbox);script.setAttribute("kis-src","https://www.dropbox.com/static/api/2/dropins.js");head.appendChild(script);var isMobile={Android:function(){return navigator.userAgent.match(/Android/i);},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i);},iOS:function(){return navigator.userAgent.match(/iPhone|iPod/i);},Opera:function(){return navigator.userAgent.match(/Opera Mini/i);},Windows:function(){return navigator.userAgent.match(/IEMobile/i);},any:function(){return(isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows());}};var val=document.getElementById("enterText").value.trim();var len=val.length;if(len==0){document.getElementById("characterCount").innerText="0";$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');}
else{document.getElementById("characterCount").innerHTML="<strong>"+len+"</strong>";if(len>characterCount){$("#plagi-error").addClass('d-block').removeClass('d-none');$("#plagi-error").html("Total characters should not be greater than "+characterCount+", For more summary, <a href='javascript:;' class='paraphrase-now'>Click here!</a>");}
else{$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');}}
if($(".sentence-half").length>0){var boxArray=$('.sentence-half').toArray();var n=$(".sentence-half").length;var sentenceHistory=new Array(n);for(var i=0;i<sentenceHistory.length;i++){sentenceHistory[i]=[boxArray[i].innerHTML];}}
$(document).on("click",".mode",function(){var mode=$(this).data("mode");if(mode){var nmode=mode.charAt(0).toUpperCase()+mode.slice(1);$(".mode").removeClass("active");$(this).addClass("active");$("#mode").val(mode);$("#dropdownMenuButton").text(nmode);$(".stepOneParaphrase").click();}});$(document).on("click",".sentence-half",function(){$(".sentence-half").removeClass("sentence-highlight");$(this).addClass("sentence-highlight");var index=$(".sentence-highlight").data("index");var counter=$(".sentence-highlight").data("counter");if($(this).hasClass("sentence-lock")){$("#lock").find('span.customToolTip').text("Unlock");$("#lock").find("img#lock-open").addClass("d-none");$("#lock").find("img#lock-close").removeClass("d-none");$("#undo,#rephrase").addClass("d-none");}
else{$("#lock").find('span.customToolTip').text("Lock");$("#lock").find("img#lock-open").removeClass("d-none");$("#lock").find("img#lock-close").addClass("d-none");$("#rephrase").removeClass("d-none");if(counter==0){$("#undo").addClass("d-none");}
else{$("#undo").removeClass("d-none");}}});$(document).on("click","#copy",function(){copyToClipboard();$("#copy").find('span.customToolTip').text("Copied");setTimeout(function(){$("#copy").find('span.customToolTip').text("Copy");},2000);});$(document).on("click","#lock",function(){var whichLock=$(this).find("img").not(".d-none").attr("id");if(whichLock=="lock-open"){$(this).find('span.customToolTip').text("Unlock");$(this).find("img#lock-open").addClass("d-none");$(this).find("img#lock-close").removeClass("d-none");$(".sentence-highlight").css('text-decoration','line-through').addClass("sentence-lock");$("#undo,#rephrase").addClass("d-none");}
else if(whichLock=="lock-close"){$(this).find('span.customToolTip').text("Lock");$(this).find("img#lock-open").removeClass("d-none");$(this).find("img#lock-close").addClass("d-none");$(".sentence-highlight").css('text-decoration','none').removeClass("sentence-lock");$("#rephrase").removeClass("d-none");var counter=$(".sentence-highlight").data("counter");if(counter==0){$("#undo").addClass("d-none");}
else{$("#undo").removeClass("d-none");}}
else{return;}
if($(".sentence-lock").length>0){$(".stepOneParaphrase").addClass("d-none");$(".Rephrase").removeClass("d-none");$(".pointer1").addClass("pointer-n");}
else{$(".stepOneParaphrase").removeClass("d-none");$(".Rephrase").addClass("d-none");$(".pointer1").removeClass("pointer-n");}});function sleepCall(i,sentenceHistory,indexp,boxArray,icounter){return new Promise((resolve)=>{setTimeout(function(){$(boxArray[i]).css('opacity','initial');$(boxArray[i]).html(sentenceHistory[i][icounter]);$(boxArray[i]).data("counter",icounter);if(i==indexp){$("#undo").removeClass("d-none");}
resolve(1);},3000);});}
function ajaxCall(i,sentenceHistory,indexp,boxArray,icounter,content,mode){return new Promise((resolve)=>{$.ajax({url:window.location.href,type:"post",data:{"action":"rephrase","content":content,"mode":mode},ajaxI:i,beforeSend:function(){$(boxArray[i]).css('opacity','0.5');},success:function(e){i=this.ajaxI;$(boxArray[i]).css('opacity','initial');if(e!=='0'){sentenceHistory[i][icounter]=e;$(boxArray[i]).html(sentenceHistory[i][icounter]);$(boxArray[i]).data("counter",icounter);}
if(i==indexp){$("#undo").removeClass("d-none");}
resolve(1);}});});}
async function processArray(sentenceHistory){var boxArray=$('.sentence-half').toArray();var mode=$.trim($("#mode").val());var indexp=$(".sentence-highlight").data("index");await disabledEverything();for(var i=0;i<sentenceHistory.length;i++){if(!$(boxArray[i]).hasClass("sentence-lock")){var content=$.trim($(boxArray[i]).text());var counter=$(boxArray[i]).data("counter");if(content){var icounter=counter+1;if(icounter>=0){$(boxArray[i]).css('opacity','0.5');if(typeof sentenceHistory[i][icounter]!=='undefined'){$(boxArray[i]).css('opacity','0.5');var p1=await sleepCall(i,sentenceHistory,indexp,boxArray,icounter);console.log("after sleep");}
else{$(boxArray[i]).css('opacity','0.5');var p2=await ajaxCall(i,sentenceHistory,indexp,boxArray,icounter,content,mode);console.log("after ajax");}}}}}
await enabledEverything();console.log(sentenceHistory);}
$(document).on("click",".Rephrase",function(){if($(".sentence-half").length>0&&$(".sentence-lock").length>0){processArray(sentenceHistory);}});$(document).on("click","#rephrase,#undo",function(){var id=$(this).attr('id');var content=$.trim($(".sentence-highlight").text());var mode=$.trim($("#mode").val());var index=$(".sentence-highlight").data("index");var counter=$(".sentence-highlight").data("counter");if(content){if(id=="rephrase"){var icounter=counter+1;}
else if(id=="undo"){var icounter=counter-1;}
else{return;}
if(icounter>=0){$(".sentence-highlight").css('opacity','0.5');disabledEverything();if(typeof sentenceHistory[index][icounter]!=='undefined'){setTimeout(function(){$(".sentence-highlight").css('opacity','initial');enabledEverything();$(".sentence-highlight").html(sentenceHistory[index][icounter]);$(".sentence-highlight").data("counter",icounter);if(icounter==0){$("#undo").addClass("d-none");}
else{$("#undo").removeClass("d-none");}},3000);}
else{if(id=="undo"){$(".sentence-highlight").css('opacity','initial');enabledEverything();return;}
$(".sentence-highlight").css('opacity','0.5');disabledEverything();$.ajax({url:window.location.href,type:"post",data:{"action":"rephrase","content":content,"mode":mode},success:function(e){$(".sentence-highlight").css('opacity','initial');enabledEverything();if(e!=='0'){sentenceHistory[index][icounter]=e;$(".sentence-highlight").html(sentenceHistory[index][icounter]);$(".sentence-highlight").data("counter",icounter);}
if(icounter==0){$("#undo").addClass("d-none");}
else{$("#undo").removeClass("d-none");}
console.log(sentenceHistory);}});}}}});$(document).on("click","#download",function(){var content=$.trim($(".paraphreasedBox").text());content=content.replace(/(\r\n|\n|\r)/gm,"");content=$.trim(content);if(content){disabledEverything();$(".stepOneParaphrase").find("img").addClass("d-none");$.ajax({url:window.location.href,type:"post",data:{"action":"download","content":content},success:function(e){if(e){var u=uploadURL+e;var req=new XMLHttpRequest();req.open("GET",u,true);req.responseType="blob";req.onload=function(event){$.ajax({url:window.location.href,type:"post",data:{"action":"remove","filename":e},success:function(o){console.log(o);}});enabledEverything();var blob=req.response;var link=document.createElement('a');link.href=window.URL.createObjectURL(blob);link.download="summary.pdf";link.click();};req.send();}}});}});function disabledEverything(){$('.stepOneParaphrase').attr('disabled',true);$("#file-attach").css('pointer-events','none');$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');$('.filechange').addClass('disabled');$(".filechange").css('pointer-events','none');$(".filechange").attr('disabled','disabled');$("#otherformgoogle").css('pointer-events','none');$("#plagi-drag").next(".cardItem").css('pointer-events','none');$(".banner-sec").css('pointer-events','none');$(".Rephrase").find("img").removeClass("d-none");$(".stepOneParaphrase").find("img").removeClass("d-none");}
function enabledEverything(){$('.stepOneParaphrase').attr('disabled',false);$("#file-attach").css('pointer-events','auto');$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');$('.filechange').removeClass('disabled');$(".filechange").css('pointer-events','auto');$(".filechange").removeAttr('disabled');$("#otherformgoogle").css('pointer-events','auto');$("#plagi-drag").next(".cardItem").css('pointer-events','auto');$(".banner-sec").css('pointer-events','auto');$(".Rephrase").find("img").addClass("d-none");$(".stepOneParaphrase").find("img").addClass("d-none");}
function copyToClipboard(){var aux=document.createElement("input");var txt=document.getElementsByClassName("paraphreasedBox")[0].innerText.trim();aux.setAttribute("value",txt);document.body.appendChild(aux);aux.select();document.execCommand("copy");document.body.removeChild(aux);}
document.getElementById("enterText").addEventListener('input',function(e){const target=e.target;const len=target.value.trim().length;if(len==0){document.getElementById("characterCount").innerText="0";$(".pointer1").addClass("pointer-n");$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');}
else{document.getElementById("characterCount").innerHTML="<strong>"+len+"</strong>";$(".pointer1").removeClass("pointer-n");if(len>characterCount){$("#plagi-error").addClass('d-block').removeClass('d-none');$("#plagi-error").html("Total characters should not be greater than "+characterCount+", For more summary, <a href='javascript:;' class='paraphrase-now'>Click here!</a>");}
else{$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');}}});$(document).on("click","#reset",function(){$(".otherOptions").removeClass("d-none");$(".resetOption").addClass("d-none");$("#enterText").val("");$("#characterCount").text("0");$(".pointer1").addClass("pointer-n");$(".pointer2").addClass("pointer-n");$("#plagi-drag").next(".cardItem").find(".placeholder ").removeClass("d-none");$("#plagi-drag").next(".cardItem").find(".paraphreasedBox ").empty();$("#plagi-drag").find(".placeholder ").removeClass("d-none");$(".stepOneParaphrase").removeClass("d-none");$(".Rephrase").addClass("d-none");$("#undo").addClass("d-none");$("#rephrase").removeClass("d-none");$("#lock").find('span.customToolTip').text("Lock");$("#lock").find("img#lock-open").removeClass("d-none");$("#lock").find("img#lock-close").addClass("d-none");$("#plagi-error").addClass('d-none').removeClass('d-block');$("#plagi-error").html('');$(".Rephrase").find("img").addClass("d-none");$(".stepOneParaphrase").find("img").addClass("d-none");if(isMobile.any()){$("#plagi-drag").next(".cardItem").addClass("d-none");}
else{$("#plagi-drag").next(".cardItem").removeClass("d-none");}});if(typeof original_content!=='undefined'){$(".pointer1").removeClass("pointer-n");}
if(typeof success!=='undefined'){$($(".paraphreasedBox").find(".sentence-half")[0]).parent("span.selected").replaceWith($($(".paraphreasedBox").find(".sentence-half")[0]).parent("span.selected").html());$(".pointer1").removeClass("pointer-n");$(".pointer2").removeClass("pointer-n");$(".otherOptions").addClass("d-none");$(".resetOption").removeClass("d-none");}
if(isMobile.any()){if(typeof success!=='undefined'){$("#plagi-drag").next(".cardItem").removeClass("d-none");}}
else{$("#plagi-drag").next(".cardItem").removeClass("d-none");}
$(document).on("click",".paraphrase-now",function(event){location.href=window.location.origin+"/Home/";});$('#enterText').on({focus:function(){$(this).closest(".card").find(".placeholder").addClass('d-none');},blur:function(){var val=$.trim($("#enterText").val());if(val==""){$(this).closest(".card").find(".placeholder").removeClass('d-none');}
else{$(this).closest(".card").find(".placeholder").addClass('d-none');}}});});